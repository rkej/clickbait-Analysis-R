---
title: "Clickbait-analysis"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
```{r}
library(dplyr)
library(ggplot2)
library(stringr)
library(stringi)
install.packages("qdap", INSTALL_opts = "--no-multiarch")
```
```{r}
library(qdap)
library(SentimentAnalysis)
```
## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}
ClickbaitData <- read.csv("dataset.csv")
head(ClickbaitData)
```

## Including Plots

You can also embed plots, for example:
Classifying Data 
```{r}
IsClickbait <- ClickbaitData %>%
  filter(class != "False")
NotClickbait <- ClickbaitData %>%
  filter(class == "False")
head(NotClickbait)
```
```{r}
ClickbaitLen<- IsClickbait %>%
  mutate(titleLen = stri_length(title))
 
NotClickBaitLen <- ClickbaitData %>%
  mutate(titleLen = stri_length(title))

NotClickBaitLen %>%
  ggplot(aes(x = class, y = titleLen)) + geom_point()


```
```{r}
NotClickBaitLen %>%
  head(2000) %>%
  group_by(class) %>%
  summarise(dislikeCount = mean(sum(dislikeCount)))%>%
  ggplot(aes(x = class, y = dislikeCount)) + geom_bar(stat = "identity")
```
```{r}
NotClickBaitLen %>%
  head(2000) %>%
  group_by(class) %>%
  summarise(ratioCount = mean(likeCount/dislikeCount))%>%
  ggplot(aes(x = class, y = ratioCount)) + geom_bar(stat = "identity")
```

```{r}
Not<- NotClickBaitLen %>%
  head(1000) %>%
  group_by(class) %>%
  mutate(polarity_title = counts(polarity(title))[, "polarity"])
Not %>%
  summarise(meanPol = mean(polarity_title))%>%
  ggplot(aes(x = class, y = meanPol)) + geom_bar(stat = "identity")


```


