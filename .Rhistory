# clean up workspace environment
rm(list = ls())
# all packages used for the assignment
library(mosaic)
library(tidyverse)
library(DataComputing)
library(lubridate)
library(party)
load(url("http://tiny.cc/dcf/MeasTreatTables.rda"))
# clean up workspace environment
rm(list = ls())
# all packages used for the assignment
library(mosaic)
library(tidyverse)
library(DataComputing)
library(lubridate)
library(party)
load(url("http://tiny.cc/dcf/MeasTreatTables.rda"))
# clean up workspace environment
rm(list = ls())
# all packages used for the assignment
library(mosaic)
library(tidyverse)
library(DataComputing)
library(lubridate)
library(party)
NCHS %>%
na.omit() %>%
nrow()
CompleteCases <-
NCHS %>%
select(diabetic, weight, age, bmi, chol, smoker) %>%
na.omit()
CompleteCases %>%
nrow()
mod1 <- party::ctree(
diabetic ~ weight + chol,
data=CompleteCases)
plot(mod1, type="simple")
CompleteCases %>%
mutate(probability = as.numeric(predict(mod1)),
likelihood =
ifelse(diabetic,
probability,
1-probability)) %>%
summarise(log_likelihood = sum(log(likelihood)))
NCHS %>%
na.omit() %>%
nrow()
CompleteCases <-
NCHS %>%
select(diabetic, weight, age, bmi, chol, smoker) %>%
na.omit()
CompleteCases %>%
nrow()
NCHS
mod1 <- party::ctree(
diabetic ~ wci + bmi,
data=CompleteCases)
NCHS %>%
na.omit() %>%
nrow()
CompleteCases <-
NCHS %>%
select(diabetic, weight, age, bmi, chol, smoker, bmi, wci) %>%
na.omit()
CompleteCases %>%
nrow()
NCHS
mod1 <- party::ctree(
diabetic ~ wci + bmi,
data=CompleteCases)
plot(mod1, type="simple")
CompleteCases %>%
mutate(probability = as.numeric(predict(mod1)),
likelihood =
ifelse(diabetic,
probability,
1-probability)) %>%
summarise(log_likelihood = sum(log(likelihood)))
CompleteCases2 <-
NCHS %>%
select(diabetic, weight, age, bmi, chol, smoker, wci) %>%
na.omit()
mod2 <- party::ctree(
diabetic ~ bmi + wci,
data=CompleteCases)
plot(mod1, type="simple")
CompleteCases2 %>%
mutate(probability = as.numeric(predict(mod1)),
likelihood =
ifelse(diabetic,
probability,
1-probability)) %>%
summarise(log_likelihood = sum(log(likelihood)))
CompleteCases2 %>%
mutate(probability = as.numeric(predict(mod1)),
likelihood =
ifelse(diabetic,
probability,
1-probability)) %>%
summarise(log_likelihood = sum(log(likelihood)))
CompleteCases2 %>%
mutate(probability = as.numeric(predict(mod2)),
likelihood =
ifelse(diabetic,
probability,
1-probability)) %>%
summarise(log_likelihood = sum(log(likelihood)))
# clean up workspace environment
rm(list = ls())
# all packages used for the assignment
library(mosaic)
library(tidyverse)
library(DataComputing)
library(lubridate)
library(party)
NCHS %>%
na.omit() %>%
nrow()
CompleteCases <-
NCHS %>%
select(diabetic, weight, age, bmi, chol, smoker) %>%
na.omit()
CompleteCases %>%
nrow()
NCHS
mod1 <- party::ctree(
diabetic ~ weight + chol,
data=CompleteCases)
plot(mod1, type="simple")
CompleteCases %>%
mutate(probability = as.numeric(predict(mod1)),
likelihood =
ifelse(diabetic,
probability,
1-probability)) %>%
summarise(log_likelihood = sum(log(likelihood)))
NCHS <- NCHS %>%
na.omit()
NCHS
CompleteCases2 <-
NCHS %>%
select(diabetic, weight, age, bmi, chol, smoker, wci) %>%
na.omit()
mod2 <- party::ctree(
diabetic ~ bmi + wci,
data=CompleteCases2)
plot(mod1, type="simple")
CompleteCases2 %>%
mutate(probability = as.numeric(predict(mod2)),
likelihood =
ifelse(diabetic,
probability,
1-probability)) %>%
summarise(log_likelihood = sum(log(likelihood)))
CompleteCases2 %>%
mutate(probability = as.numeric(predict(mod2)),
likelihood =
ifelse(diabetic,
probability,
1-probability)) %>%
summarise(log_likelihood = sum(log(likelihood)))
mod2 <- party::ctree(
diabetic ~ bmi + wci,
data=CompleteCases2)
plot(mod2, type="simple")
CompleteCases2 %>%
mutate(probability = as.numeric(predict(mod2)),
likelihood =
ifelse(diabetic,
probability,
1-probability)) %>%
summarise(log_likelihood = sum(log(likelihood)))
knitr::opts_chunk$set(echo = TRUE)
ClickbaitData <- read.csv("dataset.csv")
ClickbaitData2 <- read.csv("clickBait_Data.csv")
head(ClickbaitData2)
ClickbaitData <- read.csv("dataset.csv")
ClickbaitData2 <- read.csv("clickBait_Data.csv")
ClickbaitData2 <- ClickbaitData2 %>%
mutate(clickbait = recode(0 = "False", 1 = "True"))%>%
ClickbaitData <- read.csv("dataset.csv")
ClickbaitData2 <- read.csv("clickBait_Data.csv")
ClickbaitData2 <- ClickbaitData2 %>%
mutate(clickbait = recode(click, `0` = "False", `1` = "True"))%>%
rename(clickbait = class)
ClickbaitData <- read.csv("dataset.csv")
ClickbaitData2 <- read.csv("clickBait_Data.csv")
ClickbaitData2 <- ClickbaitData2 %>%
mutate(clickbait = recode(clickbait, `0` = "False", `1` = "True"))%>%
rename(clickbait = class)
ClickbaitData <- read.csv("dataset.csv")
ClickbaitData2 <- read.csv("clickBait_Data.csv")
ClickbaitData2 <- ClickbaitData2 %>%
mutate(clickbait = recode(clickbait, `0` = "False", `1` = "True")) %>%
rename(clickbait = "class")
library(dplyr)
library(ggplot2)
library(stringr)
library(tidyverse)
library(stringi)
install.packages("qdap", INSTALL_opts = "--no-multiarch")
library(dplyr)
library(ggplot2)
library(stringr)
library(tidyverse)
library(stringi)
library(qdap)
library(SentimentAnalysis)
ClickbaitData <- read.csv("dataset.csv")
ClickbaitData2 <- read.csv("clickBait_Data.csv")
ClickbaitData2 <- ClickbaitData2 %>%
mutate(clickbait = recode(clickbait, `0` = "False", `1` = "True")) %>%
rename(clickbait = class)
ClickbaitData <- read.csv("dataset.csv")
ClickbaitData2 <- read.csv("clickBait_Data.csv")
ClickbaitData2 <- ClickbaitData2 %>%
mutate(clickbait = recode(clickbait, `0` = "False", `1` = "True")) %>%
rename(class = clickbait)
head(ClickbaitData2)
ClickbaitData <- read.csv("dataset.csv")
ClickbaitData2 <- read.csv("clickBait_Data.csv")
ClickbaitData2 <- ClickbaitData2 %>%
mutate(clickbait = recode(clickbait, `0` = "False", `1` = "True")) %>%
rename(class = clickbait) %>%
rename(title = titles)
head(ClickbaitData2)
ClickbaitData <- read.csv("dataset.csv")
ClickbaitData2 <- read.csv("clickBait_Data.csv")
ClickbaitData2 <- ClickbaitData2 %>%
mutate(clickbait = recode(clickbait, `0` = "False", `1` = "True")) %>%
rename(class = clickbait) %>%
rename(title = titles) %>%
select(title, class)
head(ClickbaitData2)
NotClickBaitLen %>%
head(2000) %>%
group_by(class) %>%
ggplot(aes(x = likeCount, y = dislikeCount, shape = class)) + geom_point()
ClickbaitLen<- IsClickbait %>%
mutate(titleLen = stri_length(title))
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggplot2)
library(stringr)
library(tidyverse)
library(stringi)
library(qdap)
library(SentimentAnalysis)
ClickbaitData <- read.csv("dataset.csv")
ClickbaitData2 <- read.csv("clickBait_Data.csv")
ClickbaitData2 <- ClickbaitData2 %>%
mutate(clickbait = recode(clickbait, `0` = "False", `1` = "True")) %>%
rename(class = clickbait) %>%
rename(title = titles) %>%
select(title, class)
head(ClickbaitData2)
IsClickbait <- ClickbaitData %>%
filter(class != "False")
NotClickbait <- ClickbaitData %>%
filter(class == "False")
head(NotClickbait)
ClickbaitLen<- IsClickbait %>%
mutate(titleLen = stri_length(title))
NotClickBaitLen <- ClickbaitData %>%
mutate(titleLen = stri_length(title))
NotClickBaitLen %>%
ggplot(aes(x = class, y = titleLen)) + geom_point()
NotClickBaitLen %>%
head(2000) %>%
group_by(class) %>%
summarise(dislikeCount = mean(sum(dislikeCount)))%>%
ggplot(aes(x = class, y = dislikeCount)) + geom_bar(stat = "identity")
NotClickBaitLen %>%
head(2000) %>%
group_by(class) %>%
ggplot(aes(x = likeCount, y = dislikeCount, shape = class)) + geom_point()
Not<- NotClickBaitLen %>%
head(1000) %>%
group_by(class) %>%
mutate(polarity_title = counts(polarity(title))[, "polarity"])
Not %>%
summarise(meanPol = mean(polarity_title))%>%
ggplot(aes(x = class, y = meanPol)) + geom_bar(stat = "identity")
NotClickBaitLen %>%
head(500) %>%
ggplot(aes(x = likeCount, y = dislikeCount, shape = class)) + geom_point()
NotClickBaitLen %>%
head(2000) %>%
ggplot(aes(x = likeCount, y = dislikeCount, shape = class)) + geom_point()
NotClickBaitLen %>%
head(10000) %>%
ggplot(aes(x = likeCount, y = dislikeCount, shape = class)) + geom_point()
NotClickBaitLen %>%
head(100) %>%
ggplot(aes(x = likeCount, y = dislikeCount, shape = class)) + geom_point()
ClickbaitData %>%
mutate(class = recode(class, `True` = 1, `False` = 0))
mod1 <- party::ctree(
class ~ polarity_title,
data=ClickbaitData)
Not <- Not %>%
mutate(class = recode(class, `True` = 1, `False` = 0))
Not<- NotClickBaitLen %>%
head(1000) %>%
mutate(polarity_title = counts(polarity(title))[, "polarity"])
Not %>%
summarise(meanPol = mean(polarity_title))%>%
ggplot(aes(x = class, y = meanPol)) + geom_bar(stat = "identity")
Not<- NotClickBaitLen %>%
head(1000) %>%
mutate(polarity_title = counts(polarity(title))[, "polarity"])
Not %>%
group_by(class)
summarise(meanPol = mean(polarity_title))%>%
ggplot(aes(x = class, y = meanPol)) + geom_bar(stat = "identity")
Not<- NotClickBaitLen %>%
head(1000) %>%
mutate(polarity_title = counts(polarity(title))[, "polarity"])
Not %>%
group_by(class)
summarise(meanPol = mean(polarity_title))%>%
ggplot(aes(x = class, y = meanPol)) + geom_bar(stat = "identity")
Not<- NotClickBaitLen %>%
head(1000) %>%
mutate(polarity_title = counts(polarity(title))[, "polarity"])
Not %>%
group_by(class)%>%
summarise(meanPol = mean(polarity_title))%>%
ggplot(aes(x = class, y = meanPol)) + geom_bar(stat = "identity")
Not <- Not %>%
mutate(class = recode(class, `True` = 1, `False` = 0))
mod1 <- party::ctree(
class ~ polarity_title,
data=Not)
plot(mod1, type="simple")
Not <- Not %>%
mutate(class = recode(class, `True` = 1, `False` = 0))
mod1 <- party::ctree(
class ~ polarity_title + likeCount/dislikeCount,
data=Not)
plot(mod1, type="simple")
ClickbaitData <- read.csv("dataset.csv")
ClickbaitData2 <- read.csv("clickBait_Data.csv")
ClickbaitData2 <- ClickbaitData2 %>%
mutate(clickbait = recode(clickbait, `0` = "False", `1` = "True")) %>%
rename(class = clickbait) %>%
rename(title = titles)
head(ClickbaitData2)
NotClickBaitLen %>%
head(2000) %>%
group_by(class) %>%
summarise(dislikeCount = mean(dislikeCount))%>%
ggplot(aes(x = class, y = dislikeCount)) + geom_bar(stat = "identity")
ClickbaitLen<- IsClickbait %>%
mutate(titleLen = stri_length(title))
NotClickBaitLen <- ClickbaitData %>%
mutate(titleLen = stri_length(title))
NotClickBaitLen <- ClickbaitData %>%
mutate(specLen = stri_length(str_extract(title, "\\*?(!{2,})")))
NotClickBaitLen %>%
ggplot(aes(x = class, y = titleLen)) + geom_point()
ClickbaitLen<- IsClickbait %>%
mutate(titleLen = stri_length(title))
NotClickBaitLen <- ClickbaitData %>%
mutate(titleLen = stri_length(title))
SpecLen <- ClickbaitData %>%
mutate(specLen = stri_length(str_extract(title, "\\*?(!{2,})")))
NotClickBaitLen %>%
ggplot(aes(x = class, y = titleLen)) + geom_point()
ClickbaitLen<- IsClickbait %>%
mutate(titleLen = stri_length(title))
NotClickBaitLen <- ClickbaitData %>%
mutate(titleLen = stri_length(title))
SpecLen <- ClickbaitData %>%
mutate(specLen = stri_length(str_extract(title, "\\*?(!{2,})")))
SpecLen %>%
ggplot(aes(x = class, y = specLen)) + geom_point()
ClickbaitLen<- IsClickbait %>%
mutate(titleLen = stri_length(title))
NotClickBaitLen <- ClickbaitData %>%
mutate(titleLen = stri_length(title))
SpecLen <- ClickbaitData %>%
mutate(specLen = stri_length(str_extract(title, "\\*?(!{2,})")))
SpecLen %>%
ggplot(aes(x = class, y = specLen)) + geom_bar()
ClickbaitLen<- IsClickbait %>%
mutate(titleLen = stri_length(title))
NotClickBaitLen <- ClickbaitData %>%
mutate(titleLen = stri_length(title))
SpecLen <- ClickbaitData %>%
mutate(specLen = stri_length(str_extract(title, "\\*?(!{2,})")))
SpecLen %>%
ggplot(aes(x = class, y = specLen)) + geom_bar("stat = identity")
ClickbaitLen<- IsClickbait %>%
mutate(titleLen = stri_length(title))
NotClickBaitLen <- ClickbaitData %>%
mutate(titleLen = stri_length(title))
SpecLen <- ClickbaitData %>%
mutate(specLen = stri_length(str_extract(title, "\\*?(!{2,})")))
head(SpecLen)
ClickbaitLen<- IsClickbait %>%
mutate(titleLen = stri_length(title))
NotClickBaitLen <- ClickbaitData %>%
mutate(titleLen = stri_length(title))
NotClickBaitLen <- ClickbaitData %>%
mutate(titleLen = stri_length(title))
NotClickBaitLen %>%
ggplot(aes(x = class, y = titleLen)) + geom_point()
#Decision Tree
Not <- Not %>%
mutate(class = recode(class, `True` = 1, `False` = 0))
mod1 <- party::ctree(
class ~ polarity_title + likeCount/dislikeCount,
data=Not)
plot(mod1, type="simple")
NotClickBaitLen %>%
head(1000) %>%
ggplot(aes(x = likeCount, y = dislikeCount, shape = class)) + geom_point()
ClickbaitData <- read.csv("dataset.csv")
ClickbaitData2 <- read.csv("clickBait_Data.csv")
ClickbaitData2 <- ClickbaitData2 %>%
mutate(clickbait = recode(clickbait, `0` = "False", `1` = "True")) %>%
rename(class = clickbait) %>%
rename(title = titles)
JoinedData <- merge(x = ClickbaitData, y = ClickbaitData2, by = "title")
head(ClickbaitData2)
ClickbaitData <- read.csv("dataset.csv")
ClickbaitData2 <- read.csv("clickBait_Data.csv")
ClickbaitData2 <- ClickbaitData2 %>%
mutate(clickbait = recode(clickbait, `0` = "False", `1` = "True")) %>%
rename(class = clickbait) %>%
rename(title = titles)
JoinedData <- merge(x = ClickbaitData, y = ClickbaitData2, by = "title", all = TRUE)
head(ClickbaitData2)
ClickbaitData <- read.csv("dataset.csv")
ClickbaitData2 <- read.csv("clickBait_Data.csv")
ClickbaitData2 <- ClickbaitData2 %>%
mutate(clickbait = recode(clickbait, `0` = "False", `1` = "True")) %>%
rename(class = clickbait) %>%
rename(title = titles)
JoinedData <- merge(x = ClickbaitData, y = ClickbaitData2, by = "title", all = TRUE)
head(JoinedData)
ClickbaitData <- read.csv("dataset.csv")
ClickbaitData2 <- read.csv("clickBait_Data.csv")
ClickbaitData2 <- ClickbaitData2 %>%
mutate(clickbait = recode(clickbait, `0` = "False", `1` = "True")) %>%
rename(class = clickbait) %>%
rename(title = titles)
JoinedData <- merge(x = ClickbaitData, y = ClickbaitData2, by = "title", all = TRUE) %>%
select(title, class())
ClickbaitData <- read.csv("dataset.csv")
ClickbaitData2 <- read.csv("clickBait_Data.csv")
ClickbaitData2 <- ClickbaitData2 %>%
mutate(clickbait = recode(clickbait, `0` = "False", `1` = "True")) %>%
rename(class = clickbait) %>%
rename(title = titles)
JoinedData <- merge(x = ClickbaitData, y = ClickbaitData2, by = "title", all = TRUE) %>%
select(title, class
ClickbaitData <- read.csv("dataset.csv")
ClickbaitData2 <- read.csv("clickBait_Data.csv")
ClickbaitData2 <- ClickbaitData2 %>%
mutate(clickbait = recode(clickbait, `0` = "False", `1` = "True")) %>%
rename(class = clickbait) %>%
rename(title = titles)
JoinedData <- merge(x = ClickbaitData, y = ClickbaitData2, by = "title", all = TRUE) %>%
select(title, class)
ClickbaitData <- read.csv("dataset.csv")
ClickbaitData2 <- read.csv("clickBait_Data.csv")
ClickbaitData2 <- ClickbaitData2 %>%
mutate(clickbait = recode(clickbait, `0` = "False", `1` = "True")) %>%
rename(class = clickbait) %>%
rename(title = titles)
JoinedData <- merge(x = ClickbaitData, y = ClickbaitData2, by = "title", all = TRUE)
JoinedData <- JoinedData %>%
select(title, class)
ClickbaitData <- read.csv("dataset.csv")
ClickbaitData2 <- read.csv("clickBait_Data.csv")
ClickbaitData2 <- ClickbaitData2 %>%
mutate(clickbait = recode(clickbait, `0` = "False", `1` = "True")) %>%
rename(class = clickbait) %>%
rename(title = titles)
JoinedData <- merge(x = ClickbaitData, y = ClickbaitData2, by = "title", all = TRUE)
#JoinedData <- JoinedData %>%
#  select(title, class)
JoinedData %>%
head()
ClickbaitData <- read.csv("dataset.csv")
ClickbaitData2 <- read.csv("clickBait_Data.csv")
ClickbaitData2 <- ClickbaitData2 %>%
mutate(clickbait = recode(clickbait, `0` = "False", `1` = "True")) %>%
rename(class = clickbait) %>%
rename(title = titles)
JoinedData <- merge(x = ClickbaitData, y = ClickbaitData2, by = "title", all = TRUE)
JoinedData %>%
head()
Not<- NotClickBaitLen %>%
head(1000) %>%
mutate(polarity_title = counts(polarity(title))[, "polarity"])
Not %>%
group_by(class)%>%
summarise(meanPol = mean(polarity_title))%>%
ggplot(aes(x = class, y = meanPol)) + geom_bar(stat = "identity")
knitr::opts_chunk$set(echo = TRUE)
ClickbaitData <- read.csv("dataset.csv")
Not<- ClickbaitData %>%
mutate(polarity_title = counts(polarity(title))[, "polarity"])
Not %>%
group_by(class)%>%
summarise(meanPol = mean(polarity_title))%>%
ggplot(aes(x = class, y = meanPol)) + geom_bar(stat = "identity")
